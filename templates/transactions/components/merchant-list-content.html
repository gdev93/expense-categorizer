{% if uncategorized_merchants %}
<h2 class="mb-3">
     Spese Non Categorizzate
    <span class="badge merchant-list-uncategorized-badge">
        {{ uncategorized_merchants.count }}
    </span>
</h2>
<details class="expander-card merchant-list-expander">
    <summary class="expander-header">
        <span class="merchant-list-expander-summary-text">Apri</span>
        <div class="expander-toggle-btn">
            <span class="expander-icon">â–¼</span>
        </div>
    </summary>

    <div class="expander-body">
        <div class="data-list">
            {% for item in uncategorized_merchants %}
                {% include "transactions/components/merchant-list-item.html" with item=item %}
            {% endfor %}
        </div>
    </div>
</details>
{% endif %}

{% if merchant_summary %}
    <div class="header-with-action mb-3">
        <h2 class="mb-0"> Spese Categorizzate</h2>
        <button class="btn btn-primary desktop-only" 
                onclick="window.location.href='{% url 'transaction_create' %}'">
            <span class="material-icons merchant-list-add-icon">add_circle</span> Aggiungi Spesa
        </button>
        <button class="btn-fab mobile-only" 
                onclick="window.location.href='{% url 'transaction_create' %}'">
            <span class="material-icons">add</span>
        </button>
    </div>

    <div class="data-list" id="scroll-target">
        {% for item in merchant_summary %}
            {% include "transactions/components/merchant-list-item.html" with item=item %}
        {% endfor %}
    </div>

    {% include "components/pagination.html" with page_obj=merchant_summary hx_target="#transaction-results" %}
{% elif not uncategorized_merchants and not merchant_summary %}
    <!-- Empty State for Merchant View -->
    {% include "components/empty-state.html" with icon="store" title="Nessuna Transazione Trovata" description="Non ci sono transazioni che corrispondono ai filtri selezionati." %}
{% endif %}
