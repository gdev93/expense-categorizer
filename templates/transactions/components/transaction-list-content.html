<!-- Uncategorized Transactions Section -->
{% if uncategorized_transaction %}
<h2 class="mb-3">
     Spese Non Categorizzate
    <span class="badge transaction-list-uncategorized-badge">
        {{ uncategorized_transaction.count }}
    </span>
</h2>
<details class="expander-card transaction-list-expander">
    <summary class="expander-header">
        <span class="transaction-list-expander-summary-text">Apri</span>
        <div class="expander-toggle-btn">
            <span class="expander-icon">â–¼</span>
        </div>
    </summary>

    <div class="expander-body">
        <div class="data-list">
            {% for transaction in uncategorized_transaction %}
                {% include "transactions/components/transaction_item.html" with transaction=transaction show_description=True %}
            {% empty %}
                {% if transactions %}
                    <div class="data-list-item transaction-list-empty-msg">
                         Tutte le spese sono categorizzate!
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</details>
{% endif %}

<!-- Transaction List -->
{% if transactions %}
    <div class="header-with-action mb-3">
        <h2 class="mb-0"> Spese Categorizzate</h2>
        <button class="btn btn-primary desktop-only" 
                onclick="window.location.href='{% url 'transaction_create' %}'">
            <span class="material-icons transaction-list-add-icon">add_circle</span> Aggiungi Spesa
        </button>
        <button class="btn-fab mobile-only" 
                onclick="window.location.href='{% url 'transaction_create' %}'">
            <span class="material-icons">add</span>
        </button>
    </div>

    <div class="data-list" id="scroll-target">
        {% for transaction in transactions %}
            {% include "transactions/components/transaction_item.html" with transaction=transaction %}
        {% endfor %}
    </div>

    {% include "components/pagination.html" with hx_target="#transaction-results" %}

{% elif not uncategorized_transaction %}
    <!-- Empty State -->
    {% url 'transactions_upload' as upload_url %}
    {% include "components/empty-state.html" with icon="receipt_long" title="Nessuna Transazione Trovata" description="Carica un file Excel o CSV per iniziare a tracciare le tue spese." button_text="Carica File" button_url=upload_url %}
{% endif %}
